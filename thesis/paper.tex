%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% LaTeX-Rahmen fuer das Erstellen von Masterarbeiten
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% allgemeine Einstellungen
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[oneside,12pt,a4paper]{report}
\usepackage{epsf}
\usepackage{graphics, graphicx}
\usepackage{latexsym}
\usepackage[margin=10pt,font=small,labelfont=bf]{caption}
\usepackage[utf8]{inputenc}
\usepackage[toc,page]{appendix}
\usepackage{amsmath, amssymb}
\usepackage{algorithm, algpseudocode}
\usepackage{siunitx}


\usepackage[round,comma]{natbib}\bibliographystyle{plainnat}
\usepackage[backref=section, hidelinks]{hyperref}
\usepackage{url}
\usepackage{makecell}

\usepackage{todonotes}

\newcommand{\figurewidth}{0.9\linewidth}
\newcommand{\done}[2][]{\todo[color=green!40, #1]{\textbf{Done:} #2}}


\textwidth 14cm
\textheight 22cm
\topmargin 0.0cm
\evensidemargin 1cm
\oddsidemargin 1cm
%\footskip 2cm
\parskip0.5explus0.1exminus0.1ex

% Kann von Student auch nach pers\"onlichem Geschmack ver\"andert werden.
\pagestyle{headings}

\sloppy

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% hier steht die neue Titelseite 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
\begin{titlepage}
 \begin{center}
  {\LARGE Eberhard Karls Universit\"at T\"ubingen}\\
  {\large Mathematisch-Naturwissenschaftliche Fakult\"at \\
Wilhelm-Schickard-Institut f\"ur Informatik\\[4cm]}
  {\huge Master Thesis Computer Science\\[2cm]}
  {\Large\bf  Uncertainty-Aware Reinforcement Learning for Demand Response in Energy Systems\\[1.5cm]}
 {\large Ludwig Bald}\\[0.5cm]
  January 31, 2023\\[4cm]
{\small\bf Reviewers}\\[0.5cm]
  \parbox{7cm}{\begin{center}{\large Dr. Nicole Ludwig}\\
  {\footnotesize Wilhelm-Schickard-Institut für Informatik\\
	Universit\"at T\"ubingen}\end{center}}\hfill\parbox{7cm}{\begin{center}
  {\large Jun. Prof. Dr.-Ing.\\ Setareh Maghsudi}\\
  {\footnotesize Wilhelm-Schickard-Institut f\"ur Informatik\\
	Universit\"at T\"ubingen}\end{center}
 }
  \end{center}
\end{titlepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Titelr"uckseite: Bibliographische Angaben
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty}
\vspace*{\fill}
\begin{minipage}{11.2cm}
\textbf{Bald, Ludwig:}\\
\emph{Uncertainty-Aware Reinforcement Learning for Demand Response in Energy Systems}\\ Master Thesis Computer Science\\
Eberhard Karls Universit\"at T\"ubingen\\
Thesis period: July 2022-January 2023
\end{minipage}
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagenumbering{roman}
\setcounter{page}{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Seite I: Zusammenfassug, Danksagung
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section*{Abstract}
The electrical grid is increasingly dominated by renewable energy.
Therefore, demand needs to flexibly respond to changes in the amount of available electricity.
Buildings play a key role in this regard:
They consume a large amount of energy for space heating and cooling as well as providing hot water.
Intelligently controlled, they can flexibly consume energy when supply is available.

Distributional Reinforcement Learning is a class of machine learning algorithms that can efficiently explore an RL environment and learn a control policy by explicitly modeling uncertainty.
Among those, UA-DQN is an algorithm that explicitly estimates epistemic uncertainty, caused by a lack of data, and aleatoric uncertainty, caused by the environment's inherent stochasticity.

I evaluate the performance of UA-DQN on a custom RL environment for building energy management based on the 2022 CityLearn challenge.
After tuning the hyperparameters, I evaluate the algorithm against a rule-based baseline and two variants of DQN, using $\epsilon$-greedy and Boltzmann (Softmax) action selection.
All three algorithms make use of the battery, but none outperforms the baseline.
UA-DQN requires fewer environment interactions to arrive at a superior policy than both DQN variants, but demands more computational resources.

% LTeX: language=de-DE
\newpage
\section*{Zusammenfassung}
Da die Stromproduktion zunehmend auf erneuerbare Energien umgestellt wird, muss die Nachfrage flexibel auf Veränderungen der verfügbaren Produktionskapazität reagieren.
Gebäude spielen in dieser Hinsicht eine wichtige Rolle:
Sie verbrauchen einen großen Teil der Energie für Heizung und Kühlung sowie für Warmwasser.
Intelligent gesteuert können sie flexibel dann Energie verbrauchen, wenn sie verfügbar ist.

Distributional Reinforcement Learning ist eine Klasse von Algorithmen des maschinellen Lernens, die durch explizite Modellierung von Unsicherheit eine RL-Umgebung effizient erkunden und eine Steuerungspolitik erlernen können.
UA-DQN ist ein Algorithmus, der explizit die epistemische Unsicherheit, die durch einen Mangel an Daten verursacht wird, und die aleatorische Unsicherheit, die durch die inhärente Stochastizität der Umgebung verursacht wird, schätzt.

Ich bewerte die Leistung von UA-DQN in einer benutzerdefinierten RL-Umgebung für das Energiemanagement von Gebäuden auf der Grundlage der CityLearn Challenge 2022.
Ich evaluiere den Algorithmus mit optimierten Hyperparametern im Vergleich zu einer regelbasierten Baseline und zwei Varianten von DQN, die $\epsilon$-greedy und Boltzmann (Softmax) zur Aktionsauswahl verwenden.
Alle drei Algorithmen nutzen den Stromspeicher, aber keiner übertrifft die Baseline.
UA-DQN benötigt weniger Interaktionen mit der Umgebung, um zu einer den DQN-Varianten überlegenen Strategie zu gelangen, erfordert aber mehr Rechenressourcen.

% LTeX: language=en-US
\newpage
\section*{Acknowledgements}
First and foremost, I would like to express my gratitude to Nicole Ludwig for being a very approachable, kind and helpful supervisor.
I would also like to thank Francesco Chini for sharing his knowledge of the dark art of Reinforcement Learning.

I am grateful to the entire MLSES group for providing such a welcoming and social atmosphere.
I want to thank my officemates and friends for keeping me sane througout the sometimes stressful phases of this project.
Finally, of course, I want to thank Toni for everything!

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Table of Contents
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize

\tableofcontents

\renewcommand{\baselinestretch}{1}
\small\normalsize

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of Figures
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \renewcommand{\baselinestretch}{1.3}
% \small\normalsize

% \addcontentsline{toc}{chapter}{List of Figures}
% \listoffigures

% \renewcommand{\baselinestretch}{1}
% \small\normalsize

% \cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of tables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \renewcommand{\baselinestretch}{1.3}
% \small\normalsize

% \addcontentsline{toc}{chapter}{List of Tables}
% \listoftables

% \renewcommand{\baselinestretch}{1}
% \small\normalsize

% \cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of abbreviations
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% can be removed
% \addcontentsline{toc}{chapter}{List of Abbreviations}
% \chapter*{List of Abbreviations\markboth{LIST OF ABBREVIATIONS}{LIST OF ABBREVIATIONS}}

% \begin{tabbing}
% \textbf{FACTOTUM}\hspace{1cm}\=Schrott\kill
% \textbf{BLAST}\>Basic Local Alignment Search Tool \\
% \textbf{...} \> ...\\
% \end{tabbing}

% \cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Der Haupttext, ab hier mit arabischer Numerierung
%%% Mit \input{dateiname} werden die Datei `dateiname' eingebunden
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagenumbering{arabic}
\setcounter{page}{1}

%% Introduction
\input{intro}
\cleardoublepage

%% 
\input{background}
\cleardoublepage

%% 
\input{approach}
\cleardoublepage

%%
\input{results}
\cleardoublepage

%%
\input{discussion}
\cleardoublepage

%%
\input{conclusion}
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Appendix
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\appendix

%\setcounter{secnumdepth}{-1}
%\section{Tables}\label{chap:App}
%\chapter{Further Tables and Figures}\label{chap:App}


%\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Bibliographie
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\addcontentsline{toc}{chapter}{Bibliography}

\bibliography{mylit, papers}
%% Obige Anweisung legt fest, dass BibTeX-Datei `mylit.bib' verwendet
%% wird. Hier koennen mehrere Dateinamen mit Kommata getrennt aufgelistet
%% werden.

\cleardoublepage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Erklaerung
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\thispagestyle{empty}
\section*{Selbst\"andigkeitserkl\"arung}

Hiermit versichere ich, dass ich die vorliegende Masterarbeit 
selbst\"andig und nur mit den angegebenen Hilfsmitteln angefertigt habe und dass alle Stellen, die dem Wortlaut oder dem 
Sinne nach anderen Werken entnommen sind, durch Angaben von Quellen als 
Entlehnung kenntlich gemacht worden sind. 
Diese Masterarbeit wurde in gleicher oder \"ahnlicher Form in keinem anderen 
Studiengang als Pr\"ufungsleistung vorgelegt. 

\vskip 3cm
%Tübingen, 31.01.2023 \\
Ort, Datum	\hfill Unterschrift \hfill 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Ende
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}

